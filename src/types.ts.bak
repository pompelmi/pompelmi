/** Shared types for scanners */

export type Uint8ArrayLike = Uint8Array;

export type Severity = 'low' | 'medium' | 'high' | 'critical' | 'suspicious';

export type Match = {
  /** Rule/label that produced the match (e.g: 'zip_eocd_not_found') */
  rule: string;
  /** Scanner name/ID or source (optional) */
  source?: string;
  /** Match severity */
  severity?: Severity;
  /** Additional metadata (free-form) */
  meta?: Record<string, unknown>;
};

export type ScanContext = {
  filename?: string;
  mimeType?: string;
  size?: number;
};

/** Firma della funzione di scansione */
export type ScanFn = (input: Uint8Array, ctx?: ScanContext) => Promise<Match[]> | Match[];

/**
 * Uno scanner pu√≤ essere:
 * - una funzione (ScanFn)
 * - un oggetto con metodo scan(...)
 */
export type Scanner = ScanFn | { name?: string; scan: ScanFn };
