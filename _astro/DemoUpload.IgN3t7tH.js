import{r as f}from"./index.RH_Wq4ov.js";var y={exports:{}},g={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L;function _(){if(L)return g;L=1;var c=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function l(d,t,s){var e=null;if(s!==void 0&&(e=""+s),t.key!==void 0&&(e=""+t.key),"key"in t){s={};for(var o in t)o!=="key"&&(s[o]=t[o])}else s=t;return t=s.ref,{$$typeof:c,type:d,key:e,ref:t!==void 0?t:null,props:s}}return g.Fragment=n,g.jsx=l,g.jsxs=l,g}var $;function O(){return $||($=1,y.exports=_()),y.exports}var r=O(),U=({accept:c,maxSize:n,action:l,onResult:d,onError:t,onProgress:s,className:e="",label:o="Upload file"})=>{const v=f.useRef(null),[h,R]=f.useState(!1),b=()=>{v.current?.click()},j=D=>{const x=D.target.files?.[0];if(!x)return;if(n&&x.size>n){t?.(new Error(`File size exceeds maxSize (${n} bytes)`));return}const N=new FormData;N.append("file",x);const i=new XMLHttpRequest;i.open("POST",l),i.upload.onprogress=a=>{if(a.lengthComputable&&s){const m=a.loaded/a.total*100;s(m)}},i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE)if(R(!1),i.status>=200&&i.status<300)try{const a=JSON.parse(i.responseText);d?.(a)}catch(a){t?.(a)}else t?.(new Error(`Upload failed with status ${i.status}`))},R(!0),i.send(N)};return r.jsxs("div",{className:`relative inline-block ${e}`,children:[r.jsx("input",{type:"file",accept:c,ref:v,onChange:j,className:"hidden"}),r.jsx("button",{type:"button",onClick:b,disabled:h,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:h?"Uploading…":o})]})},k=U,T=({accept:c,maxSize:n,action:l,multiple:d=!1,onResult:t,onError:s,onProgress:e,className:o=""})=>{const[v,h]=f.useState(!1),[R,b]=f.useState(!1),j=f.useCallback(a=>{const m=Array.from(a);if(!m.length)return;if(!d&&m.length>1){s?.(new Error("Multiple file upload not allowed"));return}const E=m[0];if(n&&E.size>n){s?.(new Error(`File size exceeds maxSize (${n} bytes)`));return}const w=new FormData;w.append("file",E);const u=new XMLHttpRequest;u.open("POST",l),u.upload.onprogress=p=>{if(p.lengthComputable&&e){const S=p.loaded/p.total*100;e(S)}},u.onreadystatechange=()=>{if(u.readyState===XMLHttpRequest.DONE)if(b(!1),u.status>=200&&u.status<300)try{const p=JSON.parse(u.responseText);t?.(p)}catch(p){s?.(p)}else s?.(new Error(`Upload failed with status ${u.status}`))},b(!0),u.send(w)},[l,n,d,t,s,e]),D=a=>{a.preventDefault(),h(!1),a.dataTransfer.files&&j(a.dataTransfer.files)},x=a=>{a.preventDefault(),h(!0)},N=()=>h(!1),i=a=>{a.target.files&&j(a.target.files)};return r.jsxs("div",{onDragOver:x,onDragLeave:N,onDrop:D,className:`relative flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-6 text-center transition-colors ${v?"border-blue-600 bg-blue-50":"border-gray-300 bg-white"} ${o}`,children:[r.jsx("input",{id:"upload-dropzone-input",type:"file",accept:c,multiple:d,onChange:i,className:"hidden"}),r.jsx("label",{htmlFor:"upload-dropzone-input",className:"cursor-pointer",children:R?"Uploading…":"Drag and drop a file here or click to choose one"})]})},M=T;const C="".replace(/\/$/,"");function q(){const[c,n]=f.useState([]),[l,d]=f.useState(null),t=e=>n(o=>[e,...o]),s=C?`${C}/scan`:"/__engine_missing__";return r.jsxs("section",{className:"max-w-3xl mx-auto my-8 space-y-6",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsx(k,{action:s,maxSize:50*1024*1024,onResult:e=>t(`Button → ${e?.result?.malicious?"MALICIOUS":"CLEAN"}`),onError:e=>t(`Button ERROR → ${e.message}`),onProgress:e=>d(e),label:"Select a file and scansion it"})}),r.jsx(M,{action:s,maxSize:50*1024*1024,onResult:e=>t(`Dropzone → ${e?.result?.malicious?"MALICIOUS":"CLEAN"}`),onError:e=>t(`Dropzone ERROR → ${e.message}`),onProgress:e=>d(e),className:"mt-2"}),l!==null&&r.jsxs("div",{children:[r.jsx("div",{className:"h-2 w-full bg-gray-200 rounded",children:r.jsx("div",{className:"h-2 bg-black rounded transition-all",style:{width:`${Math.min(100,Math.max(0,l))}%`}})}),r.jsxs("p",{className:"text-xs mt-1",children:[l.toFixed(0),"%"]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Log"}),r.jsx("ul",{className:"text-sm space-y-1",children:c.map((e,o)=>r.jsx("li",{className:"font-mono",children:e},o))})]})]})}export{q as default};
