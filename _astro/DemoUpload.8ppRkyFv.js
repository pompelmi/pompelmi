import{r as u}from"./index.RH_Wq4ov.js";var v={exports:{}},h={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b;function C(){if(b)return h;b=1;var r=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function n(s,l,d){var o=null;if(d!==void 0&&(o=""+d),l.key!==void 0&&(o=""+l.key),"key"in l){d={};for(var m in l)m!=="key"&&(d[m]=l[m])}else d=l;return l=d.ref,{$$typeof:r,type:s,key:o,ref:l!==void 0?l:null,props:d}}return h.Fragment=i,h.jsx=n,h.jsxs=n,h}var R;function w(){return R||(R=1,v.exports=C()),v.exports}var t=w();const T="X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*",k=r=>new TextEncoder().encode(r),A=k(T);function S(r,i){e:for(let n=0;n<=r.length-i.length;n++){for(let s=0;s<i.length;s++)if(r[n+s]!==i[s])continue e;return n}return-1}function $(r){const i=r.toLowerCase().match(/\.([a-z0-9]+)$/);return i?i[1]:""}function I(r){const i=r.subarray(0,16),n=o=>o.toString(16).padStart(2,"0"),s=Array.from(i).map(n).join("");return s.startsWith("89504e470d0a1a0a")?"image/png":s.startsWith("ffd8ff")?"image/jpeg":s.startsWith("25504446")?"application/pdf":s.startsWith("504b0304")?"application/zip":s.startsWith("7b0a")||s.startsWith("7b22")?"application/json":r.slice(0,1024).every(o=>o===9||o===10||o===13||o>=32&&o<=126)?"text/plain":"application/octet-stream"}function _(r){const i=["B","KB","MB","GB"];let n=0,s=r;for(;s>=1024&&n<i.length-1;)s/=1024,n++;return`${s.toFixed(1)} ${i[n]}`}function L(){const[r,i]=u.useState([]),[n,s]=u.useState(null),[l,d]=u.useState([]),[o,m]=u.useState(!1),j=u.useRef(null),y=e=>i(c=>[e,...c]),N=u.useCallback(async e=>{const c=new Uint8Array(await e.arrayBuffer()),a=I(c),x=$(e.name),p=[];let f="clean";return S(c,A)!==-1&&(p.push({id:"EICAR",title:"EICAR test string found",description:"This is a harmless test string used to verify anti‑virus pipelines. It is flagged to prove the demo is wired up.",severity:"high"}),f="malicious"),a==="application/octet-stream"&&e.size>5*1024*1024&&(p.push({id:"opaque-large",title:"Large opaque binary",description:"Large unknown binaries may warrant deeper inspection.",severity:"medium"}),f=f==="malicious"?"malicious":"suspicious"),{fileName:e.name,size:e.size,mime:a,ext:x,verdict:f,findings:p}},[]),g=u.useCallback(async e=>{if(!e||e.length===0)return;s(0);const c=[];for(let a=0;a<e.length;a++){const x=e[a];y(`Scanning ${x.name} …`);const p=await N(x);c.push(p),s(Math.round((a+1)/e.length*100)),y(`${x.name} → ${p.verdict.toUpperCase()}`)}d(a=>[...c,...a]),s(null)},[N]),E=u.useCallback(e=>{e.preventDefault(),m(!1),g(e.dataTransfer.files)},[g]);return t.jsxs("section",{className:"max-w-3xl mx-auto my-8 space-y-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Client‑side demo (no upload)"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Files are scanned entirely in your browser. Nothing is sent to any server. To connect a real backend later, set ",t.jsx("code",{children:"PUBLIC_ENGINE_URL"})," and switch back to the server upload component."]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>j.current?.click(),className:"border px-4 py-2 rounded hover:bg-gray-50",children:"Choose file(s) and scan"}),t.jsx("input",{ref:j,type:"file",multiple:!0,className:"hidden",onChange:e=>g(e.currentTarget.files)})]}),t.jsx("div",{onDragOver:e=>{e.preventDefault(),m(!0)},onDragLeave:()=>m(!1),onDrop:E,className:`mt-2 border-2 border-dashed rounded p-6 text-center transition-colors ${o?"border-black bg-gray-50":"border-gray-300"}`,children:"Drag & drop files here"}),n!==null&&t.jsxs("div",{children:[t.jsx("div",{className:"h-2 w-full bg-gray-200 rounded",children:t.jsx("div",{className:"h-2 bg-black rounded transition-all",style:{width:`${Math.min(100,Math.max(0,n))}%`}})}),t.jsxs("p",{className:"text-xs mt-1",children:[n.toFixed(0),"%"]})]}),l.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"font-semibold",children:"Results"}),t.jsx("ul",{className:"space-y-2",children:l.map((e,c)=>t.jsxs("li",{className:"border rounded p-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-mono text-sm",children:e.fileName}),t.jsxs("div",{className:"text-xs text-gray-600",children:[_(e.size)," · ",e.mime,e.ext?` · .${e.ext}`:""]})]}),t.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${e.verdict==="malicious"?"bg-red-100 text-red-700":e.verdict==="suspicious"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-700"}`,children:e.verdict.toUpperCase()})]}),e.findings.length>0&&t.jsx("ul",{className:"mt-2 list-disc list-inside text-sm",children:e.findings.map(a=>t.jsxs("li",{children:[t.jsx("span",{className:"font-medium",children:a.title}),a.description?` — ${a.description}`:""]},a.id))})]},c))})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Log"}),t.jsx("ul",{className:"text-sm space-y-1",children:r.map((e,c)=>t.jsx("li",{className:"font-mono",children:e},c))})]})]})}export{L as default};
